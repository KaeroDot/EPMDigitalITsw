function [w, zeroRemoval] = win(L, window)
% returns N-point periodic Window in a row vector 
%   [w, zeroRemoval] = win(L, window)
% 
%   Input arguments
%     L       - window length
%     Window  - 'rect', 'bartlett', 'welch', 'hann', 'hamming',
%               'blackman', 'BH92', 'flattop',
%               'HFT70', 'HFT90D', 'HFT95', 'HFT116D',
%               'HFT144D', 'HFT169D', 'HFT196D', 'HFT223D',
%               'HFT248D'
%
%   Output argument
%     w             - window in a row vector
%     zeroRemoval   - number of bins, affected by DC value offset
%
% Reference: G. Heinzel, A. Ruediger and R. Schilling
% "Spectrum and spectral density estimation by the Discrete Fourier
%  transform (DFT), including a comprehensive list of window functions
%  and some new flat-top windows,"
% Max-Planck-Institut fur Gravitationsphysik
% (Albert-Einstein-Institut)
% Teilinstitut Hannover
% February 15, 2002
%
% Copyright (c) 2023 by Rado Lapuh
% All rights reserved.

xbin = (0:L-1)/L;
switch window
  case 'rect'    % Rectangular
    w = ones(1,L);
    zeroRemoval = 1;
  case 'bartlett'   % triangular Bartlett
    w = 2*(0:L/2-1)/L;
    w(L/2+1:L) = 2-2*(L/2:L-1)/L;
    zeroRemoval = 2;
  case 'welch'
    w = 1-(2*xbin-1).^2;
    zeroRemoval = 2;
  case 'hann'    % Hanning
    w = (1-cos(2*pi*xbin))/2;
    zeroRemoval = 2;
  case 'hamming' % Hamming
    w = 0.54-0.46*cos(2*pi*xbin);
    zeroRemoval = 2;
  case 'blackman'% Blackman
    w = 0.426591 - ...
      0.496561 * cos(2*pi*xbin) + ...
      0.076849 * cos(4*pi*xbin);
    zeroRemoval = 3;
  case 'flattop' % two term flattop
    w = 0.26526 - ...
      0.5 * cos(2*pi*xbin) + ...
      0.23474 * cos(4*pi*xbin);
    zeroRemoval = 3;
  case 'BH92'    % Blackman-Harris with 92 dB side lobe
    w = 0.35875 - ...
      0.48829 * cos(2*pi*xbin) + ...
      0.14128 * cos(4*pi*xbin) - ...
      0.01168 * cos(6*pi*xbin);
    zeroRemoval = 4;
  case 'HFT70'
    w = 1 - ...
      1.90796 * cos( 2*pi*xbin) + ...
      1.07349 * cos( 4*pi*xbin) - ...
      0.18199 * cos( 6*pi*xbin);
    zeroRemoval = 4;
  case 'HFT90D'
    w = 1 - ...
      1.942604 * cos( 2*pi*xbin) + ...
      1.340318 * cos( 4*pi*xbin) - ...
      0.440811 * cos( 6*pi*xbin) + ...
      0.043097 * cos( 8*pi*xbin);
    zeroRemoval = 5;
  case 'HFT95'
    w = 1 - ...
      1.9383379 * cos( 2*pi*xbin) + ...
      1.3045202 * cos( 4*pi*xbin) - ...
      0.4028270 * cos( 6*pi*xbin) + ...
      0.0350665 * cos( 8*pi*xbin);
    zeroRemoval = 5;
  case 'HFT116D' % five term lovest sidelobe flat-top window
    w = 1 - ...
      1.9575375 * cos( 2*pi*xbin) + ...
      1.4780705 * cos( 4*pi*xbin) - ...
      0.6367431 * cos( 6*pi*xbin) + ...
      0.1228389 * cos( 8*pi*xbin) - ...
      0.0066288 * cos(10*pi*xbin);
    zeroRemoval = 6;
  case 'HFT144D' % six term lovest sidelobe flat-top window
    w = 1 - ...
      1.96760033 * cos( 2*pi*xbin) + ...
      1.57983607 * cos( 4*pi*xbin) - ...
      0.81123644 * cos( 6*pi*xbin) + ...
      0.22583558 * cos( 8*pi*xbin) - ...
      0.02773848 * cos(10*pi*xbin) + ...
      0.00090360 * cos(12*pi*xbin);
    zeroRemoval = 7;
  case 'HFT169D' % seven term lovest sidelobe flat-top window
    w = 1 - ...
      1.97441842 * cos( 2*pi*xbin) + ...
      1.65409888 * cos( 4*pi*xbin) - ...
      0.95788186 * cos( 6*pi*xbin) + ...
      0.33673420 * cos( 8*pi*xbin) - ...
      0.06364621 * cos(10*pi*xbin) + ...
      0.00521942 * cos(12*pi*xbin) - ...
      0.00010599 * cos(14*pi*xbin);
    zeroRemoval = 8;
  case 'HFT196D' % eight term lovest sidelobe flat-top window
    w = 1 - ...
      1.979280420 * cos( 2*pi*xbin) + ...
      1.710288951 * cos( 4*pi*xbin) - ...
      1.081629853 * cos( 6*pi*xbin) + ...
      0.448734314 * cos( 8*pi*xbin) - ...
      0.112376628 * cos(10*pi*xbin) + ...
      0.015122992 * cos(12*pi*xbin) - ...
      0.000871252 * cos(14*pi*xbin) + ...
      0.000011896 * cos(16*pi*xbin);
    zeroRemoval = 9;
  case 'HFT223D' % nineth term lovest sidelobe flat-top window
    w = 1 - ...
      1.98298997309 * cos( 2*pi*xbin) + ...
      1.75556083063 * cos( 4*pi*xbin) - ...
      1.19037717712 * cos( 6*pi*xbin) + ...
      0.56155440797 * cos( 8*pi*xbin) - ...
      0.17296769663 * cos(10*pi*xbin) + ...
      0.03233247087 * cos(12*pi*xbin) - ...
      0.00324954578 * cos(14*pi*xbin) + ...
      0.00013801040 * cos(16*pi*xbin) - ...
      0.00000132725 * cos(16*pi*xbin);
    zeroRemoval = 10;
  case 'HFT248D' % tenth term lovest sidelobe flat-top window
    w = 1 - ...
      1.985844164102 * cos( 2*pi*xbin) + ...
      1.791176438506 * cos( 4*pi*xbin) - ...
      1.282075284005 * cos( 6*pi*xbin) + ...
      0.667777530266 * cos( 8*pi*xbin) - ...
      0.240160796576 * cos(10*pi*xbin) + ...
      0.056656381764 * cos(12*pi*xbin) - ...
      0.008134974479 * cos(14*pi*xbin) + ...
      0.000624544650 * cos(16*pi*xbin) - ...
      0.000019808998 * cos(16*pi*xbin) + ...
      0.000000132974 * cos(16*pi*xbin);
    zeroRemoval = 11;
  otherwise % none
    w = ones(1,L);
    zeroRemoval = 1;
end

end